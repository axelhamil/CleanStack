# Value Objects

Immutable, validated business concepts.

## Definition

Value Objects are defined by their **attributes**, not identity. Two emails with same value are equal.

```typescript
const email1 = Email.create({ value: 'user@example.com' }).value
const email2 = Email.create({ value: 'user@example.com' }).value
email1.equals(email2) // true
```

## Structure

```typescript
import { Result, ValueObject } from '@packages/ddd-kit'

interface EmailProps {
  value: string
}

export class Email extends ValueObject<EmailProps> {
  // Only implement validate() - parent provides create(), equals(), value
  protected validate(props: EmailProps): Result<EmailProps> {
    if (!EMAIL_REGEX.test(props.value)) {
      return Result.fail('Invalid email format')
    }
    // Return normalized value
    return Result.ok({ value: props.value.toLowerCase().trim() })
  }
}
```

## Usage

```typescript
// Create
const emailResult = Email.create({ value: 'USER@EXAMPLE.COM' })

if (emailResult.isFailure) return Result.fail(emailResult.error)

const email = emailResult.value
console.log(email.value.value) // "user@example.com"

// Comparison
email1.equals(email2) // Compares all props
```

## Example: Money

```typescript
interface MoneyProps {
  amount: number
  currency: 'EUR' | 'USD' | 'GBP'
}

export class Money extends ValueObject<MoneyProps> {
  protected validate(props: MoneyProps): Result<MoneyProps> {
    if (props.amount < 0) return Result.fail('Amount must be positive')
    return Result.ok(props)
  }

  add(other: Money): Result<Money> {
    if (this.value.currency !== other.value.currency) {
      return Result.fail('Currency mismatch')
    }
    return Money.create({
      amount: this.value.amount + other.value.amount,
      currency: this.value.currency
    })
  }

  multiply(factor: number): Result<Money> {
    return Money.create({
      amount: this.value.amount * factor,
      currency: this.value.currency
    })
  }
}
```

## When to Use

**Use Value Object:**
- Has validation rules (Email, Money)
- Should be immutable
- Equality by value, not identity
- Has business logic (`Money.add()`)

**Use Primitive:**
- No validation needed
- Simple string/number

**Use Entity:**
- Has unique identity
- Should be mutable

## Rules

### ✅ Do
```typescript
// Implement validate()
protected validate(props): Result<Props> {
  if (invalid) return Result.fail('error')
  return Result.ok({ ...normalized })
}

// Add business methods
add(other: Money): Result<Money>
```

### ❌ Don't
```typescript
// Unnecessary - parent provides
private constructor(props) { }
static create(props) { }
get value() { }

// No setters (immutable)
set value(v) { }
```

## Next Steps

- [Entities](/docs/core-concepts/entities)
- [First Use Case](/docs/guides/first-use-case)
